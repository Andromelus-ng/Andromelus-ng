var IniP=false;
var TimePA=0,TimePAL=(new Date().getTime())/1000;
var WidthP;
var sceneP1;
var sceneP2;
var rendererP1;
var rendererP2;

var SpriteBack1,SpritePolygon1,SpriteCh1O1,SpriteCh2O1,SpriteCh3O1,SpriteCh1R1,SpriteCh2R1,SpriteCh3R1,SpritePCh1O1,SpritePCh2O1,SpritePCh3O1,SpritePCh1R1,SpritePCh2R1,SpritePCh3R1;
var SpriteBack2,SpritePolygon2,SpriteCh1O2,SpriteCh2O2,SpriteCh3O2,SpriteCh1R2,SpriteCh2R2,SpriteCh3R2,SpritePCh1O2,SpritePCh2O2,SpritePCh3O2,SpritePCh1R2,SpritePCh2R2,SpritePCh3R2;

var ChasseO1=new Array();
var ChasseOP1=new Array();
ChasseO1["A1"]=0;
ChasseO1["A2"]=0;
ChasseO1["A3"]=0;
ChasseOP1["A1"]=0;
ChasseOP1["A2"]=0;
ChasseOP1["A3"]=0;
var ChassePolyO1=new Array();
ChassePolyO1[0]=new PIXI.Point(0,0);
ChassePolyO1[1]=new PIXI.Point(0,0);
ChassePolyO1[2]=new PIXI.Point(0,0);

var ChasseR1=new Array();
var ChasseRP1=new Array();
ChasseR1["A1"]=0;
ChasseR1["A2"]=0;
ChasseR1["A3"]=0;
ChasseRP1["A1"]=0;
ChasseRP1["A2"]=0;
ChasseRP1["A3"]=0;
var ChassePolyR1=new Array();
ChassePolyR1[0]=new PIXI.Point(0,0);
ChassePolyR1[1]=new PIXI.Point(0,0);
ChassePolyR1[2]=new PIXI.Point(0,0);


var ChasseO2=new Array();
var ChasseOP2=new Array();
ChasseO2["A1"]=0;
ChasseO2["A2"]=0;
ChasseO2["A3"]=0;
ChasseOP2["A1"]=0;
ChasseOP2["A2"]=0;
ChasseOP2["A3"]=0;
var ChassePolyO2=new Array();
ChassePolyO2[0]=new PIXI.Point(0,0);
ChassePolyO2[1]=new PIXI.Point(0,0);
ChassePolyO2[2]=new PIXI.Point(0,0);

var ChasseR2=new Array();
var ChasseRP2=new Array();
ChasseR2["A1"]=0;
ChasseR2["A2"]=0;
ChasseR2["A3"]=0;
ChasseRP2["A1"]=0;
ChasseRP2["A2"]=0;
ChasseRP2["A3"]=0;
var ChassePolyR2=new Array();
ChassePolyR2[0]=new PIXI.Point(0,0);
ChassePolyR2[1]=new PIXI.Point(0,0);
ChassePolyR2[2]=new PIXI.Point(0,0);


var TxBuffer=new Array();
function getTx(code){
	if(TxBuffer[code]==undefined){
		TxBuffer[code] = PIXI.Texture.fromImage(code);
	}
	return TxBuffer[code];
}

function InitRenderer(){
	WidthP = 150;
	//-----Poly1-----
	sceneP1 = new PIXI.Container();
	rendererP1 = new PIXI.autoDetectRenderer(WidthP, WidthP,{transparent: true});
	
	document.getElementById("PolyCh1").appendChild(rendererP1.view);
	
	rendererP1.view.style.position='absolute';
	rendererP1.view.style.top='0px';
	rendererP1.view.style.left='0px';
	rendererP1.view.style.width=WidthP+'px';
	rendererP1.view.style.height=WidthP+'px';
	rendererP1.view.style.zIndex='1';
	
	SpriteBack1 = new PIXI.Container();
	sceneP1.addChild(SpriteBack1);
	SpriteBack1.position.x=WidthP/2;
	SpriteBack1.position.y=WidthP/2;
	
	SpritePolygon1 = new PIXI.Graphics();
	SpriteBack1.addChild(SpritePolygon1);
	
	SpriteCh1O1 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringG1.png"));
	SpriteCh1O1.anchor.x = 0.5;
	SpriteCh1O1.anchor.y = 0.5;
	SpriteCh1O1.scale.x=0.45;
	SpriteCh1O1.scale.y=0.45;
	SpriteBack1.addChild(SpriteCh1O1);
	
	SpriteCh2O1 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringG2.png"));
	SpriteCh2O1.anchor.x = 0.5;
	SpriteCh2O1.anchor.y = 0.5;
	SpriteCh2O1.scale.x=0.37;
	SpriteCh2O1.scale.y=0.37;
	SpriteBack1.addChild(SpriteCh2O1);
	
	SpriteCh3O1 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringG2.png"));
	SpriteCh3O1.anchor.x = 0.5;
	SpriteCh3O1.anchor.y = 0.5;
	SpriteCh3O1.scale.x=0.3;
	SpriteCh3O1.scale.y=0.3;
	SpriteBack1.addChild(SpriteCh3O1);
	
	SpriteCh1R1 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringB1.png"));
	SpriteCh1R1.anchor.x = 0.5;
	SpriteCh1R1.anchor.y = 0.5;
	SpriteCh1R1.scale.x=0.42;
	SpriteCh1R1.scale.y=0.42;
	SpriteBack1.addChild(SpriteCh1R1);
	
	SpriteCh2R1 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringB2.png"));
	SpriteCh2R1.anchor.x = 0.5;
	SpriteCh2R1.anchor.y = 0.5;
	SpriteCh2R1.scale.x=0.33;
	SpriteCh2R1.scale.y=0.33;
	SpriteBack1.addChild(SpriteCh2R1);
	
	SpriteCh3R1 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringB2.png"));
	SpriteCh3R1.anchor.x = 0.5;
	SpriteCh3R1.anchor.y = 0.5;
	SpriteCh3R1.scale.x=0.27;
	SpriteCh3R1.scale.y=0.27;
	SpriteBack1.addChild(SpriteCh3R1);
	
	SpritePCh1O1 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursO.png"));
	SpritePCh1O1.anchor.x = 0.5;
	SpritePCh1O1.anchor.y = 0.5;
	SpritePCh1O1.scale.x=0;
	SpritePCh1O1.scale.y=0;
	SpriteBack1.addChild(SpritePCh1O1);
	
	SpritePCh2O1 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursO.png"));
	SpritePCh2O1.anchor.x = 0.5;
	SpritePCh2O1.anchor.y = 0.5;
	SpritePCh2O1.scale.x=0;
	SpritePCh2O1.scale.y=0;
	SpritePCh2O1.rotation=2*Math.PI/3;
	SpriteBack1.addChild(SpritePCh2O1);
	
	SpritePCh3O1 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursO.png"));
	SpritePCh3O1.anchor.x = 0.5;
	SpritePCh3O1.anchor.y = 0.5;
	SpritePCh3O1.scale.x=0;
	SpritePCh3O1.scale.y=0;
	SpritePCh3O1.rotation=-2*Math.PI/3;
	SpriteBack1.addChild(SpritePCh3O1);
	
	SpritePCh1R1 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursR.png"));
	SpritePCh1R1.anchor.x = 0.5;
	SpritePCh1R1.anchor.y = 0.5;
	SpritePCh1R1.scale.x=0;
	SpritePCh1R1.scale.y=0;
	SpriteBack1.addChild(SpritePCh1R1);
	
	SpritePCh2R1 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursR.png"));
	SpritePCh2R1.anchor.x = 0.5;
	SpritePCh2R1.anchor.y = 0.5;
	SpritePCh2R1.scale.x=0;
	SpritePCh2R1.scale.y=0;
	SpritePCh2R1.rotation=2*Math.PI/3;
	SpriteBack1.addChild(SpritePCh2R1);
	
	SpritePCh3R1 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursR.png"));
	SpritePCh3R1.anchor.x = 0.5;
	SpritePCh3R1.anchor.y = 0.5;
	SpritePCh3R1.scale.x=0;
	SpritePCh3R1.scale.y=0;
	SpritePCh3R1.rotation=-2*Math.PI/3;
	SpriteBack1.addChild(SpritePCh3R1);
	
	var graphics = new PIXI.Graphics();
	SpriteBack1.addChild(graphics);
	
	graphics.lineStyle(1, 0xf3a33f);
	graphics.moveTo(0, 0);
	graphics.lineTo(0, -WidthP/2);
	graphics.moveTo(0, 0);
	graphics.lineTo(WidthP/2*Math.cos(-Math.PI/6), -WidthP/2*Math.sin(-Math.PI/6));
	graphics.moveTo(0, 0);
	graphics.lineTo(WidthP/2*Math.cos(-5*Math.PI/6), -WidthP/2*Math.sin(-5*Math.PI/6));
	
	//-----Poly2-----
	sceneP2 = new PIXI.Container();
	rendererP2 = new PIXI.autoDetectRenderer(WidthP, WidthP,{transparent: true});
	
	document.getElementById("PolyCh2").appendChild(rendererP2.view);
	
	rendererP2.view.style.position='absolute';
	rendererP2.view.style.top='0px';
	rendererP2.view.style.left='0px';
	rendererP2.view.style.width=WidthP+'px';
	rendererP2.view.style.height=WidthP+'px';
	rendererP2.view.style.zIndex='1';
	
	SpriteBack2 = new PIXI.Container();
	sceneP2.addChild(SpriteBack2);
	SpriteBack2.position.x=WidthP/2;
	SpriteBack2.position.y=WidthP/2;
	
	SpritePolygon2 = new PIXI.Graphics();
	SpriteBack2.addChild(SpritePolygon2);
	
	SpriteCh1O2 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringG1.png"));
	SpriteCh1O2.anchor.x = 0.5;
	SpriteCh1O2.anchor.y = 0.5;
	SpriteCh1O2.scale.x=0.45;
	SpriteCh1O2.scale.y=0.45;
	SpriteBack2.addChild(SpriteCh1O2);
	
	SpriteCh2O2 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringG2.png"));
	SpriteCh2O2.anchor.x = 0.5;
	SpriteCh2O2.anchor.y = 0.5;
	SpriteCh2O2.scale.x=0.37;
	SpriteCh2O2.scale.y=0.37;
	SpriteBack2.addChild(SpriteCh2O2);
	
	SpriteCh3O2 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringG2.png"));
	SpriteCh3O2.anchor.x = 0.5;
	SpriteCh3O2.anchor.y = 0.5;
	SpriteCh3O2.scale.x=0.3;
	SpriteCh3O2.scale.y=0.3;
	SpriteBack2.addChild(SpriteCh3O2);
	
	SpriteCh1R2 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringB1.png"));
	SpriteCh1R2.anchor.x = 0.5;
	SpriteCh1R2.anchor.y = 0.5;
	SpriteCh1R2.scale.x=0.42;
	SpriteCh1R2.scale.y=0.42;
	SpriteBack2.addChild(SpriteCh1R2);
	
	SpriteCh2R2 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringB2.png"));
	SpriteCh2R2.anchor.x = 0.5;
	SpriteCh2R2.anchor.y = 0.5;
	SpriteCh2R2.scale.x=0.33;
	SpriteCh2R2.scale.y=0.33;
	SpriteBack2.addChild(SpriteCh2R2);
	
	SpriteCh3R2 = new PIXI.Sprite(getTx("../SkinRC/Cadres/ringB2.png"));
	SpriteCh3R2.anchor.x = 0.5;
	SpriteCh3R2.anchor.y = 0.5;
	SpriteCh3R2.scale.x=0.27;
	SpriteCh3R2.scale.y=0.27;
	SpriteBack2.addChild(SpriteCh3R2);
	
	SpritePCh1O2 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursO.png"));
	SpritePCh1O2.anchor.x = 0.5;
	SpritePCh1O2.anchor.y = 0.5;
	SpritePCh1O2.scale.x=0;
	SpritePCh1O2.scale.y=0;
	SpriteBack2.addChild(SpritePCh1O2);
	
	SpritePCh2O2 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursO.png"));
	SpritePCh2O2.anchor.x = 0.5;
	SpritePCh2O2.anchor.y = 0.5;
	SpritePCh2O2.scale.x=0;
	SpritePCh2O2.scale.y=0;
	SpritePCh2O2.rotation=2*Math.PI/3;
	SpriteBack2.addChild(SpritePCh2O2);
	
	SpritePCh3O2 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursO.png"));
	SpritePCh3O2.anchor.x = 0.5;
	SpritePCh3O2.anchor.y = 0.5;
	SpritePCh3O2.scale.x=0;
	SpritePCh3O2.scale.y=0;
	SpritePCh3O2.rotation=-2*Math.PI/3;
	SpriteBack2.addChild(SpritePCh3O2);
	
	SpritePCh1R2 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursR.png"));
	SpritePCh1R2.anchor.x = 0.5;
	SpritePCh1R2.anchor.y = 0.5;
	SpritePCh1R2.scale.x=0;
	SpritePCh1R2.scale.y=0;
	SpriteBack2.addChild(SpritePCh1R2);
	
	SpritePCh2R2 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursR.png"));
	SpritePCh2R2.anchor.x = 0.5;
	SpritePCh2R2.anchor.y = 0.5;
	SpritePCh2R2.scale.x=0;
	SpritePCh2R2.scale.y=0;
	SpritePCh2R2.rotation=2*Math.PI/3;
	SpriteBack2.addChild(SpritePCh2R2);
	
	SpritePCh3R2 = new PIXI.Sprite(getTx("../SkinRC/Icones/PolyCursR.png"));
	SpritePCh3R2.anchor.x = 0.5;
	SpritePCh3R2.anchor.y = 0.5;
	SpritePCh3R2.scale.x=0;
	SpritePCh3R2.scale.y=0;
	SpritePCh3R2.rotation=-2*Math.PI/3;
	SpriteBack2.addChild(SpritePCh3R2);
	
	var graphics = new PIXI.Graphics();
	SpriteBack2.addChild(graphics);
	
	graphics.lineStyle(1, 0xf3a33f);
	graphics.moveTo(0, 0);
	graphics.lineTo(0, -WidthP/2);
	graphics.moveTo(0, 0);
	graphics.lineTo(WidthP/2*Math.cos(-Math.PI/6), -WidthP/2*Math.sin(-Math.PI/6));
	graphics.moveTo(0, 0);
	graphics.lineTo(WidthP/2*Math.cos(-5*Math.PI/6), -WidthP/2*Math.sin(-5*Math.PI/6));
	
	
	if(!IniP){
		IniP=true;
		FrameP();
	}
}

function FrameP(){
	if(!IniP){
		return;
	}
	if(!document.getElementById("PolyCh1")){
		IniP=false;
		return;
	}
	var Delta=(new Date().getTime())/1000-TimePAL;
	TimePA+=Delta;
	TimePAL=(new Date().getTime())/1000;
	//-----Poly1-----
	for(var i=1;i<=3;i++){
		ChasseOP1["A"+i]=Math.max(0,Math.min(1,ChasseOP1["A"+i]+Delta*(ChasseO1["A"+i]-ChasseOP1["A"+i])));
		ChasseRP1["A"+i]=Math.max(0,Math.min(1,ChasseRP1["A"+i]+Delta*(ChasseR1["A"+i]-ChasseRP1["A"+i])));
	}
	ChassePolyO1[0].x=0;
	ChassePolyO1[0].y=-WidthP/2*ChasseOP1["A1"];
	
	ChassePolyO1[1].x=WidthP/2*ChasseOP1["A2"]*Math.cos(-Math.PI/6);
	ChassePolyO1[1].y=-WidthP/2*ChasseOP1["A2"]*Math.sin(-Math.PI/6);
	
	ChassePolyO1[2].x=WidthP/2*ChasseOP1["A3"]*Math.cos(-5*Math.PI/6);
	ChassePolyO1[2].y=-WidthP/2*ChasseOP1["A3"]*Math.sin(-5*Math.PI/6);
	
	ChassePolyR1[0].x=0;
	ChassePolyR1[0].y=-WidthP/2*ChasseRP1["A1"];
	
	ChassePolyR1[1].x=WidthP/2*ChasseRP1["A2"]*Math.cos(-Math.PI/6);
	ChassePolyR1[1].y=-WidthP/2*ChasseRP1["A2"]*Math.sin(-Math.PI/6);
	
	ChassePolyR1[2].x=WidthP/2*ChasseRP1["A3"]*Math.cos(-5*Math.PI/6);
	ChassePolyR1[2].y=-WidthP/2*ChasseRP1["A3"]*Math.sin(-5*Math.PI/6);
	
	SpritePolygon1.clear();
	
	SpritePolygon1.beginFill(0x0ba500,0.75);
	SpritePolygon1.lineStyle(1, 0x0ba500, 1);
	SpritePolygon1.drawPolygon(ChassePolyO1);
	SpritePolygon1.endFill();
	
	SpritePolygon1.beginFill(0xe9b822,0.6);
	SpritePolygon1.lineStyle(1, 0xe9b822, 1);
	SpritePolygon1.drawPolygon(ChassePolyR1);
	SpritePolygon1.endFill();
	
	SpriteCh1O1.rotation=2*Math.PI*ChasseOP1["A1"];
	SpriteCh2O1.rotation=2*Math.PI*ChasseOP1["A2"];
	SpriteCh3O1.rotation=2*Math.PI*ChasseOP1["A3"];
	
	SpriteCh1R1.rotation=2*Math.PI*ChasseRP1["A1"];
	SpriteCh2R1.rotation=2*Math.PI*ChasseRP1["A2"];
	SpriteCh3R1.rotation=2*Math.PI*ChasseRP1["A3"];
	
	SpritePCh1O1.scale.x=1.5*ChasseOP1["A1"];
	SpritePCh1O1.scale.y=1.5*ChasseOP1["A1"];
	SpritePCh2O1.scale.x=1.5*ChasseOP1["A2"];
	SpritePCh2O1.scale.y=1.5*ChasseOP1["A2"];
	SpritePCh3O1.scale.x=1.5*ChasseOP1["A3"];
	SpritePCh3O1.scale.y=1.5*ChasseOP1["A3"];
	
	SpritePCh1R1.scale.x=1.5*ChasseRP1["A1"];
	SpritePCh1R1.scale.y=1.5*ChasseRP1["A1"];
	SpritePCh2R1.scale.x=1.5*ChasseRP1["A2"];
	SpritePCh2R1.scale.y=1.5*ChasseRP1["A2"];
	SpritePCh3R1.scale.x=1.5*ChasseRP1["A3"];
	SpritePCh3R1.scale.y=1.5*ChasseRP1["A3"];
	
	//-----Poly2-----
	for(var i=1;i<=3;i++){
		ChasseOP2["A"+i]=Math.max(0,Math.min(1,ChasseOP2["A"+i]+Delta*(ChasseO2["A"+i]-ChasseOP2["A"+i])));
		ChasseRP2["A"+i]=Math.max(0,Math.min(1,ChasseRP2["A"+i]+Delta*(ChasseR2["A"+i]-ChasseRP2["A"+i])));
	}
	ChassePolyO2[0].x=0;
	ChassePolyO2[0].y=-WidthP/2*ChasseOP2["A1"];
	
	ChassePolyO2[1].x=WidthP/2*ChasseOP2["A2"]*Math.cos(-Math.PI/6);
	ChassePolyO2[1].y=-WidthP/2*ChasseOP2["A2"]*Math.sin(-Math.PI/6);
	
	ChassePolyO2[2].x=WidthP/2*ChasseOP2["A3"]*Math.cos(-5*Math.PI/6);
	ChassePolyO2[2].y=-WidthP/2*ChasseOP2["A3"]*Math.sin(-5*Math.PI/6);
	
	ChassePolyR2[0].x=0;
	ChassePolyR2[0].y=-WidthP/2*ChasseRP2["A1"];
	
	ChassePolyR2[1].x=WidthP/2*ChasseRP2["A2"]*Math.cos(-Math.PI/6);
	ChassePolyR2[1].y=-WidthP/2*ChasseRP2["A2"]*Math.sin(-Math.PI/6);
	
	ChassePolyR2[2].x=WidthP/2*ChasseRP2["A3"]*Math.cos(-5*Math.PI/6);
	ChassePolyR2[2].y=-WidthP/2*ChasseRP2["A3"]*Math.sin(-5*Math.PI/6);
	
	SpritePolygon2.clear();
	
	SpritePolygon2.beginFill(0x0ba500,0.75);
	SpritePolygon2.lineStyle(1, 0x0ba500, 1);
	SpritePolygon2.drawPolygon(ChassePolyO2);
	SpritePolygon2.endFill();
	
	SpritePolygon2.beginFill(0xe9b822,0.6);
	SpritePolygon2.lineStyle(1, 0xe9b822, 1);
	SpritePolygon2.drawPolygon(ChassePolyR2);
	SpritePolygon2.endFill();
	
	SpriteCh1O2.rotation=2*Math.PI*ChasseOP2["A1"];
	SpriteCh2O2.rotation=2*Math.PI*ChasseOP2["A2"];
	SpriteCh3O2.rotation=2*Math.PI*ChasseOP2["A3"];
	
	SpriteCh1R2.rotation=2*Math.PI*ChasseRP2["A1"];
	SpriteCh2R2.rotation=2*Math.PI*ChasseRP2["A2"];
	SpriteCh3R2.rotation=2*Math.PI*ChasseRP2["A3"];
	
	SpritePCh1O2.scale.x=1.5*ChasseOP2["A1"];
	SpritePCh1O2.scale.y=1.5*ChasseOP2["A1"];
	SpritePCh2O2.scale.x=1.5*ChasseOP2["A2"];
	SpritePCh2O2.scale.y=1.5*ChasseOP2["A2"];
	SpritePCh3O2.scale.x=1.5*ChasseOP2["A3"];
	SpritePCh3O2.scale.y=1.5*ChasseOP2["A3"];
	
	SpritePCh1R2.scale.x=1.5*ChasseRP2["A1"];
	SpritePCh1R2.scale.y=1.5*ChasseRP2["A1"];
	SpritePCh2R2.scale.x=1.5*ChasseRP2["A2"];
	SpritePCh2R2.scale.y=1.5*ChasseRP2["A2"];
	SpritePCh3R2.scale.x=1.5*ChasseRP2["A3"];
	SpritePCh3R2.scale.y=1.5*ChasseRP2["A3"];
	
	
	requestAnimationFrame(FrameP);
	
	rendererP1.render(sceneP1);
	rendererP2.render(sceneP2);
}